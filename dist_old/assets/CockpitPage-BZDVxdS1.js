import{j as e,u as s}from"./index-BsIC7uMs.js";import{r as t}from"./vendor-DENY9G7l.js";import{X as l,k as a,w as i,r,t as n,P as d,f as c,e as o,R as m,s as x,C as h,H as g}from"./icons-C2lZ9bAH.js";import{u}from"./router-DBkyO5U2.js";import{f as b}from"./utils-DKsTS5kk.js";function y({isOpen:s,onClose:r,booking:n,onRebook:d}){const[c,o]=t.useState(""),[m,x]=t.useState(!1),h=(new Date).toISOString().split("T")[0];if(!s||!n)return null;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Rebook Your Trip"}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(l,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Current Booking"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsx("div",{className:"font-medium",children:(()=>{switch(n.type){case"flight":return`Flight ${n.item.flightNumber}`;case"hotel":case"product":return n.item.name;case"car":return`${n.item.brand} ${n.item.model}`;default:return"Booking"}})()}),e.jsx("div",{children:(()=>{switch(n.type){case"flight":const e=n.item;return`${e.origin?.code||"N/A"} → ${e.destination?.code||"N/A"}`;case"hotel":return n.item.location||"N/A";case"car":return n.item.pickupLocation||"N/A";case"product":return n.item.description||"N/A";default:return"N/A"}})()}),e.jsxs("div",{children:["Current Date: ",new Date(n.bookingDate).toLocaleDateString()]}),e.jsxs("div",{children:["Amount: Rs. ",n.totalAmount]})]})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),c){x(!0);try{await d(n.id,c),r()}catch(s){console.error("Rebooking failed:",s)}finally{x(!1)}}},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"date",value:c,onChange:e=>o(e.target.value),min:h,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select a future date for your rebooking"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(i,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium",children:"Important Information"}),e.jsxs("ul",{className:"mt-1 space-y-1",children:[e.jsx("li",{children:"• Rebooking is subject to availability"}),e.jsx("li",{children:"• Price may vary based on new dates"}),e.jsx("li",{children:"• Original booking will be updated once confirmed"}),e.jsx("li",{children:"• Processing may take 24-48 hours"})]})]})]})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!c||m,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Processing...":"Request Rebooking"})]})]})]})]})})}function p(){const{state:i,dispatch:p}=s(),j=u(),[N,f]=t.useState("overview"),[v,w]=t.useState(null),[k,D]=t.useState(!1),[T,A]=t.useState({isOpen:!1,booking:null});if(!i.currentUser)return j("/login"),null;const S=s=>{switch(s){case"flight":return e.jsx(d,{className:"h-5 w-5"});case"hotel":return e.jsx(g,{className:"h-5 w-5"});case"car":return e.jsx(h,{className:"h-5 w-5"});default:return e.jsx(x,{className:"h-5 w-5"})}},M=e=>{switch(e){case"confirmed":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},O=e=>{switch(e){case"Bronze":return"text-orange-600 bg-orange-100";case"Silver":default:return"text-gray-600 bg-gray-100";case"Gold":return"text-yellow-600 bg-yellow-100";case"Platinum":return"text-purple-600 bg-purple-100"}},R=i.bookings.reduce((e,s)=>e+s.totalAmount,0),C=i.bookings.filter(e=>"flight"===e.type&&"confirmed"===e.status).length;return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[k&&e.jsx("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4 animate-fade-in",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-green-100 p-2 rounded-full",children:e.jsx(r,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-green-800 font-medium",children:"Refund Processing"}),e.jsx("p",{className:"text-green-700 text-sm",children:"Soon your money will be reflected in your bank account. This process typically takes 5-7 business days."})]}),e.jsx("button",{onClick:()=>D(!1),className:"text-green-600 hover:text-green-800",children:e.jsx(l,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 rounded-lg shadow-lg text-white p-8 mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold mb-2",children:["Welcome back, ",i.currentUser.firstName,"!"]}),e.jsx("p",{className:"text-blue-200",children:"Manage your bookings, view your travel history, and track your loyalty status"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium ${O(i.currentUser.membershipTier)} bg-white`,children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),i.currentUser.membershipTier," Member"]}),e.jsxs("div",{className:"mt-2 text-2xl font-bold",children:[i.currentUser.loyaltyMiles.toLocaleString()," Miles"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsx(d,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:C}),e.jsx("div",{className:"text-sm text-gray-600",children:"Upcoming Trips"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:e.jsx(r,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["Rs. ",R.toFixed(0)]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Spent"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:e.jsx(n,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:i.currentUser.loyaltyMiles.toLocaleString()}),e.jsx("div",{className:"text-sm text-gray-600",children:"Loyalty Miles"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-orange-100 p-3 rounded-full",children:e.jsx(a,{className:"h-6 w-6 text-orange-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:i.bookings.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Bookings"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md mb-8",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"overview",label:"Overview"},{id:"bookings",label:"My Bookings"},{id:"history",label:"Travel History"},{id:"loyalty",label:"Loyalty Program"}].map(s=>e.jsx("button",{onClick:()=>f(s.id),className:"py-4 px-1 border-b-2 font-medium text-sm "+(N===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:s.label},s.id))})}),e.jsxs("div",{className:"p-6",children:["overview"===N&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),i.bookings.length>0?e.jsx("div",{className:"space-y-4",children:i.bookings.slice(0,3).map(s=>e.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-full text-blue-600",children:S(s.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:["flight"===s.type&&`Flight ${s.item.flightNumber}`,"hotel"===s.type&&s.item.name,"car"===s.type&&`${s.item.brand} ${s.item.model}`,"product"===s.type&&s.item.name]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Booked on ",b(new Date(s.bookingDate),"MMM dd, yyyy")]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:["Rs. ",s.totalAmount]}),e.jsx("div",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${M(s.status)}`,children:s.status})]})]},s.id))}):e.jsx("p",{className:"text-gray-600",children:"No recent activity"})]})}),"bookings"===N&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"All Bookings"}),i.bookings.length>0?e.jsx("div",{className:"space-y-4",children:i.bookings.map(s=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-full text-blue-600",children:S(s.type)}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-1",children:["flight"===s.type&&`Flight ${s.item.flightNumber}`,"hotel"===s.type&&s.item.name,"car"===s.type&&`${s.item.brand} ${s.item.model}`,"product"===s.type&&s.item.name]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:["flight"===s.type&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.item.origin.code," → ",s.item.destination.code]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{className:"h-4 w-4"}),e.jsx("span",{children:b(new Date(s.item.departureTime),"MMM dd, yyyy HH:mm")})]})]}),"hotel"===s.type&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{className:"h-4 w-4"}),e.jsx("span",{children:s.item.location})]}),e.jsxs("div",{children:["Booking ID: ",s.id]}),e.jsxs("div",{children:["Booked: ",b(new Date(s.bookingDate),"MMM dd, yyyy")]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xl font-bold text-gray-900 mb-2",children:["Rs. ",s.totalAmount]}),e.jsx("div",{className:`inline-flex px-3 py-1 text-sm font-medium rounded-full ${M(s.status)} mb-3`,children:s.status}),"confirmed"===s.status&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>(async e=>{w(e),await new Promise(e=>setTimeout(e,1500)),p({type:"CANCEL_BOOKING",payload:e}),D(!0),w(null),setTimeout(()=>D(!1),5e3),p({type:"ADD_NOTIFICATION",payload:{message:"Booking cancelled successfully. Refund will be processed within 5-7 business days.",type:"info",read:!1}})})(s.id),disabled:v===s.id,className:"w-full bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:[e.jsx(l,{className:"h-4 w-4"}),e.jsx("span",{children:v===s.id?"Cancelling...":"Cancel"})]}),e.jsxs("button",{onClick:()=>A({isOpen:!0,booking:s}),className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center space-x-2",children:[e.jsx(m,{className:"h-4 w-4"}),e.jsx("span",{children:"Rebook"})]})]})]})]})},s.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(d,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No bookings yet"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Start planning your next adventure!"}),e.jsx("button",{onClick:()=>j("/flights"),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-semibold transition-colors",children:"Book a Flight"})]})]}),"history"===N&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Travel History"}),e.jsxs("div",{className:"text-center py-12",children:[e.jsx(a,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Travel History"}),e.jsx("p",{className:"text-gray-600",children:"Your completed trips will appear here"})]})]}),"loyalty"===N&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-700 rounded-lg p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Loyalty Program"}),e.jsxs("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${O(i.currentUser.membershipTier)} bg-white`,children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),i.currentUser.membershipTier," Member"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold",children:i.currentUser.loyaltyMiles.toLocaleString()}),e.jsx("div",{className:"text-purple-200",children:"Miles Available"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Tier Benefits"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[e.jsx("li",{children:"• Priority check-in"}),e.jsx("li",{children:"• Extra baggage allowance"}),e.jsx("li",{children:"• Lounge access"}),e.jsx("li",{children:"• Seat upgrades"}),e.jsx("li",{children:"• Bonus miles earning"})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Miles Activity"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Miles Earned This Year"}),e.jsxs("span",{className:"font-medium",children:["+",i.currentUser.loyaltyMiles]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Miles Redeemed"}),e.jsx("span",{className:"font-medium",children:"-0"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Miles Expiring Soon"}),e.jsx("span",{className:"font-medium",children:"0"})]})]})]})]})]})]})]})]}),e.jsx(y,{isOpen:T.isOpen,booking:T.booking,onClose:()=>A({isOpen:!1,booking:null}),onRebook:async(e,s)=>{const t=i.bookings.find(s=>s.id===e);if(!t)return;const l={id:Math.random().toString(36).substr(2,9),originalBookingId:e,newDate:s,status:"pending",requestedAt:(new Date).toISOString()};p({type:"ADD_REBOOKING_REQUEST",payload:l}),p({type:"ADD_NOTIFICATION",payload:{message:"Rebooking request submitted successfully. We will process it within 24-48 hours.",type:"success",read:!1}}),setTimeout(()=>{p({type:"UPDATE_REBOOKING_REQUEST",payload:{id:l.id,status:"confirmed",processedAt:(new Date).toISOString()}});const a={...t,id:Math.random().toString(36).substr(2,9),bookingDate:s,originalBookingId:e,isRebooked:!0,rebookedFrom:t.bookingDate,rebookedTo:s};p({type:"ADD_BOOKING",payload:a}),p({type:"ADD_NOTIFICATION",payload:{message:"Rebooking confirmed! A new booking has been created for the selected date.",type:"success",read:!1}})},2e3)}})]})}export{p as CockpitPage};
